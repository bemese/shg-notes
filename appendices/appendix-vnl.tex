\section{Matrix elements of $\bfv^\nl_{nm}(\bfk)$}\label{appvnl}
We obtain the matrix elements of $\bfv^\nl_{nm}(\bfk)$ by using
the following commutator in a
real-space basis
\begin{eqnarray}\label{cn0}
\bra{\bfR'}[\hat\bfr,\hat V(\hat\bfr,\hat\bfr')]\ket{\bfR}
&=&
\bra{\bfR'}(\hat\bfr\hat V(\hat\bfr,\hat\bfr')
-
\hat V(\hat\bfr,\hat\bfr')\hat\bfr
)
\ket{\bfR}
\nonumber\\
&=&
\int d\bfR''\bra{\bfR'}\hat\bfr\ket{\bfR''}\bra{\bfR''}\hat V(\hat\bfr,\hat\bfr') \ket{\bfR}
-
\int d\bfR''\bra{\bfR'}\hat V(\hat\bfr,\hat\bfr')\ket{\bfR''}\bra{\bfR''}\hat\bfr\ket{\bfR}
\nonumber\\
&=&
\int d\bfR'' \bfR''\gd(\bfR'-\bfR'')
\bra{\bfR''}\hat V(\hat\bfr,\hat\bfr') \ket{\bfR}
-
\int d\bfR''\bra{\bfR'}\hat V(\hat\bfr,\hat\bfr')\ket{\bfR''}\bfR\gd(\bfR''-\bfR)
\nonumber\\
&=&
\bfR'\bra{\bfR'}\hat V(\hat\bfr,\hat\bfr') \ket{\bfR}
-
\bra{\bfR'}\hat V(\hat\bfr,\hat\bfr')\ket{\bfR}\bfR
\nonumber\\
&=&
\bfR'
V(\bfR,\bfR')
-
V(\bfR,\bfR')
\bfR
=
\bfR'
V(\bfR,\bfR')
-
\bfR
 V(\bfR,\bfR')
\nonumber\\
\bra{\bfR'}[\hat V(\hat\bfr,\hat\bfr'),\hat\bfr]\ket{\bfR}
&=&
\bfR
V(\bfR,\bfR')
-
\bfR'
 V(\bfR,\bfR')
\nonumber\\
\bra{\bfR}[\hat V(\hat\bfr,\hat\bfr'),\hat\bfr]\ket{\bfR'}
&=&
\bfR'
V(\bfR,\bfR')
-
\bfR
 V(\bfR,\bfR')
,
\end{eqnarray} 
where we used $\hat\bfr\ket{\bfR}=\bfR\ket{\bfR}$, and
the matrix elements of the non-local operator
$\bra{\bfR'}\hat V(\hat\bfr,\hat\bfr')\ket{\bfR}=V(\bfR,\bfR')$ just a
function, no longer an operator, and thus it commutes with $\bfR$ and $\bfR'$.
Now we distinguish operators and non-operators by the carate symbol,
\verb=^=, on top.
We want to calculate
\begin{eqnarray}\label{cn2}
\bra{n\bfk}[\hat V^\nl(\hat\bfr,\hat\bfr'),\hat r^a]\ket{m\bfk'}
&=&
\int d\bfr d\bfr'
\bra{n\bfk}
\ket{\bfr}\bra{\bfr}
[\hat V^\nl(\hat\bfr,\hat\bfr'),\hat r^a]
\ket{\bfr'}\bra{\bfr'}
\ket{m\bfk'}
\nonumber\\
&=&
\int d\bfr d\bfr'
\psi^*_{n\bfk}(\bfr)
(  
r'^a V^\nl(\bfr,\bfr')
-  
r^aV^\nl(\bfr,\bfr')
)
\psi_{m\bfk'}(\bfr')
,
\end{eqnarray}  
where due to the fact that the integrand is periodic in real space,
$\bfk=\bfk'$ where $\bfk$ is restricted to the Brillouin Zone.
In plane waves we have that
\begin{eqnarray}\label{cn3}
\psi_{n\bfk}(\bfr)=\frac{1}{\sqrt{\gO}}
\sum_{\bfK} C_{n\bfk}(\bfK)e^{i(\bfk+\bfK)\cdot\bfr}
,
\end{eqnarray}
where $\gO$ is the volume of the unit cell.
Then,
\begin{eqnarray}\label{cn4}
\bra{n\bfk}[\hat V^\nl(\hat\bfr,\hat\bfr'),\hat r^a]\ket{m\bfk}
&=&
\frac{1}{\gO}
\sum_{\bfK,\bfK'} 
C^*_{n\bfk}(\bfK) 
C_{m\bfk}(\bfK')
\int d\bfr d\bfr' 
e^{-i(\bfk+\bfK)\cdot \bfr}
 ( 
r'^a V^\nl(\bfr,\bfr')
- 
r^aV^\nl(\bfr,\bfr')
) 
e^{i(\bfk+\bfK')\cdot \bfr'}
.
\nonumber\\
\end{eqnarray} 
Using the following identity 
\begin{eqnarray}\label{cn51}
(\nabla_\bfK+\nabla_\bfK')
\int e^{-i\bfK\cdot\bfr}
V^\nl(\bfr,\bfr')
e^{i\bfK'\cdot\bfr'}
\,d\bfr d\bfr'
&=&
-i
\int e^{-i\bfK\cdot\bfr}
\left(
\bfr
V^\nl(\bfr,\bfr')
-
V^\nl(\bfr,\bfr')
\bfr'
\right)
e^{i\bfK'\cdot\bfr'}
\,d\bfr d\bfr'
\nonumber\\
&=&
i
\int e^{-i\bfK\cdot\bfr}
\left(
\bfr'
V^\nl(\bfr,\bfr')
-
\bfr
 V^\nl(\bfr,\bfr')
\right)
e^{i\bfK'\cdot\bfr'}
\,d\bfr d\bfr'
,
\nonumber\\
\end{eqnarray}
then, we obtain
\begin{eqnarray}\label{cn52}
\bra{n\bfk}[\hat V^\nl(\hat\bfr,\hat\bfr'),\hat r^a]\ket{m\bfk}
&=&
-\frac{i}{\gO}
\sum_{\bfK,\bfK'}
C^*_{n\bfk}(\bfK)
C_{m\bfk}(\bfK')
(\nabla_{K^\rma}+\nabla_{K'^\rma})
\int e^{-i\bfK\cdot\bfr}
V^\nl(\bfr,\bfr')
e^{i\bfK'\cdot\bfr'}
\,d\bfr d\bfr'
\nonumber\\
&=&
-\frac{i}{\gO}
\sum_{\bfK,\bfK'}
C^*_{n\bfk}(\bfK)
C_{m\bfk}(\bfK')
(\nabla_{K^\rma}+\nabla_{K'^\rma})
\bra{\bfK} 
V^\nl
\ket{\bfK'} 
,
\end{eqnarray}
where
\begin{eqnarray}\label{cn6}
\bra{\bfK} 
V^\nl
\ket{\bfK'} 
=
\int e^{-i\bfK\cdot\bfr}
V^\nl(\bfr,\bfr')
e^{i\bfK'\cdot\bfr'}
\,d\bfr d\bfr'
.
\end{eqnarray}
For fully  separable pseudopotentials in the 
Kleinman-Bylander form,\cite{motta_implementation_2010,kleinman_efficacious_1982,adolph_nonlocality_1996}
above matrix elements 
can be readily calculated.\cite{francesco}
Therefore,
\begin{eqnarray}\label{cn8}
\frac{i}{\hbar}
\bra{n\bfk}[\hat V^\nl(\hat\bfr,\hat\bfr'),\hat r^\rma]\ket{m\bfk'}
=\gd(\bfk-\bfk') \bfv^\nl_{nm}(\bfk)
,
\end{eqnarray}
where $\bfv^\nl_{nm}(\bfk)$ are known quantities.

