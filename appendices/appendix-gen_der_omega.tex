\section{Generalized derivative $(\go_n(\bfk))_{;\bfk}$}\label{gwk}

We obtain the
generalized derivative $(\go_n(\bfk))_{;\bfk}$.
We start from
\begin{eqnarray}\label{a_conH0}
\bra{n\bfk}\hat{H}^S_0\ket{m\bfk'}=\gd_{nm}\gd(\bfk-\bfk')\hbar\go^S_m(\bfk)
,
\end{eqnarray}
then Eq.~\eqref{gendev} gives for $n=m$
\begin{eqnarray}\label{a_genderH0}
(H^S_{0,nn})_{;\bfk}&=&
\nabla_\bfk
H^S_{0,n n}(\bfk)
-
i
H^S_{0,nn}(\bfk)
\left(
\bfgxi_{nn}(\bfk)
-
\bfgxi_{nn}(\bfk)
\right)
\nonumber\\
&=&
\hbar\nabla_\bfk\go^S_m(\bfk)
,
\end{eqnarray}
where from Eq.~\eqref{conmri3}, 
\begin{eqnarray}\label{a_rih0}
\bra{n\bfk}[\hat\bfr_i,\hat{H}_0]\ket{m\bfk}&=&
i\gd_{nm}\hbar(\go^S_m(\bfk))_{;\bfk}
=
i\gd_{nm}\hbar\nabla_\bfk\go^S_m(\bfk)
,
\end{eqnarray}
then
\begin{eqnarray}\label{a_wgendev}
(\go^S_n(\bfk))_{;\bfk}=
\nabla_\bfk\go^S_n(\bfk)
.
\end{eqnarray}
From Eq.~\eqref{vop} 
\begin{eqnarray}\label{a_hr}
\bra{n\bfk}[\hat\bfr,\hat{H}_0]\ket{m\bfk}=
i\hbar\bfv^\gS_{nm}
,
\end{eqnarray}
therefore, substituting above into
\begin{eqnarray}\label{a_hrt}
\bra{n\bfk}[\hat\bfr,\hat{H}_0]\ket{m\bfk}=
\bra{n\bfk}[\hat\bfr_i,\hat{H}_0]\ket{m\bfk}
+
\bra{n\bfk}[\hat\bfr_e,\hat{H}_0]\ket{m\bfk}
,
\end{eqnarray}
we get
\begin{eqnarray}\label{a_hrt2}
i\hbar\bfv^\gS_{nm}=
i\gd_{nm}\hbar\nabla_\bfk\go^S_m(\bfk)
+
\go^S_{mn}\bfr_{e,nm}
,
\end{eqnarray}
from where
\begin{eqnarray}\label{a_gradw}
\nabla_\bfk\go^S_n(\bfk)
&=&
\bfv^\gS_{nn}
\nonumber\\
\nabla_\bfk(\go^\lda_n(\bfk)+\frac{\gD}{\hbar}(1-f_n))
&=&
\nabla_\bfk\go^\lda_n(\bfk)
\nonumber\\
\nabla_\bfk\go^\lda_n(\bfk)
&=&
\bfv^\gS_{nn}
,
\end{eqnarray}
where we used Eq.~\eqref{chon.78},
but from 
Eq.~\eqref{chon.2}, $v^S_{nn}=0$, and then
$\bfv^\gS_{nn}=v^\lda_{nn}$.
Thus,  from Eq.~\eqref{a_wgendev}
\begin{eqnarray}\label{a_gradw2}
(\go^S_n(\bfk))_{;k^{\rma}}=
(\go^\lda_n(\bfk))_{;k^{\rma}}=
v^{\lda,\rma}_{nn}(\bfk)
,
\end{eqnarray}
the same for the LDA and scissored Hamiltonians; $\bfv_{nn}^\lda(\bfk)$ are
the LDA velocities of the electron in state $\ket{n\bfk}$.
